<!DOCTYPE html>
<html>
  
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  <meta name="author" content="Wang Jialu">
  
  
  <title>Django | WangJiaLu `s blog</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
    <meta name="keywords" content="Django,Django,">
  

  
  <meta name="description" content="Django一.软件框架一个软件框架是有期中各个软件模块组成的，每一个模块都有特定功能，模块与模块之间通过相互配合来完成软件开发。">

  

  

  
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  

  

  

  <script>
  // theme-ad's config script
  // it can be used in every script
  
  window.AD_CONFIG = {
    leancloud: {"appid":"Hyq9wkH495DgNHWhDQCOfQSp-gzGzoHsz","appkey":"WaR7nrzhliHj9aVwdQzkdlGd","comment":false,"count":false},
    welcome: {"enable":false,"interval":30},
    start_time: "2016-02-10",
    passwords: ["efe07af7441da2b69c4a41e42e73be4db47f66010a56900788a458354a7373ec", ],
    is_post: true,
    lock: false,
    author: "Wang Jialu",
    share: {"twitter":false,"facebook":false,"weibo":false,"qq":false,"wechat":false},
    mathjax: true,
    page_type: "",
    root: "/"
  };
</script>

  <script src="/vendor/sha256.min.js"></script>
<script src="/js/auth.js"></script>
<script src="/js/index.js"></script>
<script src="/vendor/qrcode.min.js"></script>

  
    <link rel="icon" href="/images/favicon.ico">
    <link rel="apple-touch-icon" href="/images/touch-icon.png">
  

  <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

  <link rel="stylesheet" href="/css/index.css">
<link rel="stylesheet" href="/styles/components/highlight/highlight.css">

  
</head>
  <body>
    <header class="site-header">
  <div class="site-header-brand">
    
      <span class="site-header-brand-title">
        <a href="/">Giraffe.*</a>
      </span>
    
    
      <span class="site-header-brand-motto"> | 心有所向 眼及之处皆是远方.</span>
    
  </div>
  <div class="site-header-right">
    <nav class="site-header-navigation">
      
        <a href="/" target="_self">首页</a>
      
        <a href="/archives/" target="_self">归档</a>
      
        <a href="/tags/" target="_self">标签</a>
      
        <a href="/categories/" target="_self">分类</a>
      
        <a href="/friends/" target="_self">友链</a>
      
        <a href="/about/" target="_self">关于</a>
      
    </nav>
    <div class="site-header-btn">
      
        <a href="https://github.com/Giraffe-w" target="_blank" id="site-github">
          <i class="fa fa-github-alt"></i>
        </a>
      
      <a href="javascript:void(0);" id="site-search">
        <i class="fa fa-search"></i>
      </a>
      <a href="javascript:void(0);" id="site-nav-btn">
        <i class="fa fa-ellipsis-v"></i>
      </a>
    </div>
  </div>
</header>
<nav class="table-content" id="site-nav">
  <div class="table-content-title">
    <span>导航</span>
  </div>
  <div class="table-content-main">
    <ol class="toc">
      
        <li class="toc-item">
          <a href="/" target="_self">
            首页
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/archives/" target="_self">
            归档
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/tags/" target="_self">
            标签
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/categories/" target="_self">
            分类
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/friends/" target="_self">
            友链
          </a>
        </li>
      
        <li class="toc-item">
          <a href="/about/" target="_self">
            关于
          </a>
        </li>
      
    </ol>
  </div>
</nav>
<div id="site-process"></div>
    <main>
      
  <div class="passage">
  <div class="passage-meta">
    <span>
      <i class="fa fa-calendar"></i>2017-01-26
    </span>
    
      <span>
        | <a href="/categories/Django/"><i class="fa fa-bookmark"></i>Django</a>
      </span>
    
    
      <span>
        | <i class="fa fa-unlock-alt"></i>UNLOCK
      </span>
    
  </div>
  <h1 class="passage-title">
    Django
  </h1>
  
  <article class="passage-article">
    <p>#Django</p>
<h2 id="一-软件框架-1"><a href="#一-软件框架-1" class="headerlink" title="一.软件框架"></a>一.软件框架</h2><p>一个软件框架是有期中<strong><em>各个软件模块组</em></strong>成的，<strong><em>每一个模块都有特定功能</em></strong>，模块与模块之间通过<strong><em>相互配合</em></strong>来完成软件开发。</p>
<h2 id="二-MVC框架"><a href="#二-MVC框架" class="headerlink" title="二.MVC框架"></a>二.MVC框架</h2><p>MVC的核心思想：<strong>解耦</strong> </p>
<p>MVC框架里面的三个模块：</p>
<ul>
<li>M：Model模型，和数据库进行交互。</li>
<li>V：View视图，产生HTML页面。</li>
<li>C：Controller控制器，接收请求，进行处理，与M和V进行交互，返回应答。</li>
</ul>
<h2 id="三-MVT"><a href="#三-MVT" class="headerlink" title="三.MVT"></a>三.MVT</h2><ul>
<li>M：Model模型。和MVC中的M功能相同，和数据库进行交互。</li>
<li>V：View视图。和MVC中C功能相同，接收请求，进行处理，与M和T进行交互，返回应答。</li>
<li>T：Template,模板。和MVC中V功能相同，产生HTML页面。</li>
</ul>
<h2 id="四：虚拟环境"><a href="#四：虚拟环境" class="headerlink" title="四：虚拟环境"></a>四：虚拟环境</h2><p>点击查看：Django网站<a href="http://www.djangoproject.com" target="_blank" rel="noopener">www.djangoproject.com</a></p>
<p>点击查看：Django1.8.2中文文档<a href="http://www.python.usyiyi.cn" target="_blank" rel="noopener">www.python.usyiyi.cn</a></p>
<ul>
<li><p>之前安装的Python包的命令：sudo pip3 install 包名</p>
</li>
<li><p>包的安装路径： /usr/local/lib/python3.5.0/dist-packages</p>
</li>
<li><p>安装同一个包不同版本，后安装的包会把原来安装的包覆盖掉。这样，如同一台机器上两个项目依赖于相同包的不同版本，则会导致一些项目运行失败。</p>
</li>
<li><p><strong>解决方案就是:虚拟环境</strong></p>
</li>
<li><p><strong>虚拟环境就是Phthon环境的复制版本。</strong></p>
</li>
<li><p><strong>在虚拟环境中使用的Python是复制的Python安装Python包也是安装在复制的Python中。</strong></p>
</li>
</ul>
<p>安装虚拟环境的命令：</p>
<blockquote>
<p>安装虚拟环境所需要的包</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install virtialenv             //安装虚拟环境</span><br><span class="line">sudo pip install virtualenvwrapper       //安装虚拟环境拓展包</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在主目录下边编辑配置文件</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">编辑家目录下面的     </span><br><span class="line">vi .bashrc文件，                   <span class="comment">//添加下面两行到末尾</span></span><br><span class="line">i              <span class="comment">//写入</span></span><br><span class="line">export WORKON_HOME=$HOME/.virtualenvs          <span class="comment">//￥HOME 代表家目录的路径</span></span><br><span class="line">source /usr/local/bin/virtualenvwrapper.sh     <span class="comment">//创建虚拟环境要使用一些命令要想直接使用命令就得把这两句话加上</span></span><br><span class="line">Esc    </span><br><span class="line">：wq   <span class="comment">//保存退出</span></span><br><span class="line">source.bashrc        <span class="comment">//使其生效一下</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>创建虚拟环境</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">makvirtualenv         //创建虚拟环境</span><br><span class="line">例子：</span><br><span class="line">mkvirtualenv -p python3 bj18_py3</span><br><span class="line">创建虚拟环境      指定版本  虚拟环境的名称</span><br></pre></td></tr></table></figure>

<blockquote>
<p>退出虚拟环境</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deactivate              //退出虚拟环境</span><br></pre></td></tr></table></figure>

<blockquote>
<p>进入虚拟环境 </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">workon       //进入虚拟环境</span><br><span class="line">列:workon bj18_py3        输入命令 指定需要进入到那个虚拟环境</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看机器上有多少个虚拟环境</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">输入 workon 加上 空格 和两个 Tab</span><br></pre></td></tr></table></figure>

<blockquote>
<p>删除虚拟环境</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rmvirtualenv 加上 需要删除虚拟环境的名字</span><br></pre></td></tr></table></figure>

<blockquote>
<p>查看当前虚拟环境下面安装了多少Python包</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip list</span><br><span class="line">pip freeze</span><br></pre></td></tr></table></figure>

<blockquote>
<p>安装指定版本的包</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django==2.0.4</span><br></pre></td></tr></table></figure>

<h2 id="五-项目创建"><a href="#五-项目创建" class="headerlink" title="五:项目创建"></a>五:项目创建</h2><blockquote>
<p>命令</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">django-admin startproject 项目名</span><br></pre></td></tr></table></figure>

<h3 id="1-目录结构"><a href="#1-目录结构" class="headerlink" title="1.目录结构"></a>1.目录结构</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">__init__.py                   //说着这个文件是一个python包</span><br><span class="line">settings.py                   //项目的配置文件</span><br><span class="line">urls.py                     //进行Url路由的配置</span><br><span class="line">wsgi.py                //web服务器和我们的Django交互的入口</span><br><span class="line">manage.py              //项目的管理文件</span><br></pre></td></tr></table></figure>

<h3 id="2-创建应用"><a href="#2-创建应用" class="headerlink" title="2.创建应用"></a>2.创建应用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp booktest</span><br><span class="line">python  manage.py  startapp  应用名字</span><br></pre></td></tr></table></figure>

<ul>
<li><p>应用文件下面的文件作用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  __init__.py               //说明目录是一个Python模块</span><br><span class="line">  models.py                    //写和数据库相关的内容</span><br><span class="line">  views.py           //接受请求、进行处理、与M和T进行交互、返回应答.定义处理函数（视图函数）</span><br><span class="line">  tests.py       //写测试代码的文件</span><br><span class="line">admin.py        //网站后台管理相关的文件</span><br></pre></td></tr></table></figure>


</li>
</ul>
<p>  建立应用和项目之间的连续，需要对应用进行注册</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">项目名————&gt;settings.py   --↓</span><br><span class="line">INSTALLED_APPS = [</span><br><span class="line">    &apos;django.contrib.admin&apos;,</span><br><span class="line">    &apos;django.contrib.auth&apos;,</span><br><span class="line">    &apos;django.contrib.contenttypes&apos;,</span><br><span class="line">    &apos;django.contrib.sessions&apos;,</span><br><span class="line">    &apos;django.contrib.messages&apos;,</span><br><span class="line">    &apos;django.contrib.staticfiles&apos;,</span><br><span class="line">    &apos;booktes&apos;,         &lt;-----以应用的名字进行项目注册</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>启动项目</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure>

<h2 id="六-ORM"><a href="#六-ORM" class="headerlink" title="六.ORM"></a>六.ORM</h2><p>ORM 可以通过类和对象去操作他对应的表，不需要sql语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object:对象 - 类</span><br><span class="line">Mapping:映射</span><br><span class="line">Relations:关系，关系数据库中的表</span><br></pre></td></tr></table></figure>

<p>models.py            //这个文件的作用是 设计和表对应的类，模型类</p>
<h2 id="七-模型类"><a href="#七-模型类" class="headerlink" title="七.模型类"></a>七.模型类</h2><h3 id="1-模型类设计"><a href="#1-模型类设计" class="headerlink" title="1.模型类设计"></a>1.模型类设计</h3><p>在应用models.py 中设计模型类。</p>
<p>必须继承与models.Model类</p>
<p>Models.ForeignKey可以建立两个模型之间一对多的关系，Django在成功生成表的时候，就会在表中管创建一列作为外键，建立两个表之间一对多的关系。</p>
<h3 id="2-模型类生成表"><a href="#2-模型类生成表" class="headerlink" title="2.模型类生成表"></a>2.模型类生成表</h3><ul>
<li><p>生成迁移文件</p>
<p>命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br></pre></td></tr></table></figure>

<p>迁移文件是根据模型类生成的</p>
</li>
<li><p>执行迁移生成表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>

<p>migrate 里面的迁移文件不能删，因为每次迁移都有依赖关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Administrator\Desktop\Django&gt;python manage.py migrate</span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: admin, auth, booktest, contenttypes, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">  Applying contenttypes<span class="number">.0001</span>_initial... OK</span><br><span class="line">  Applying auth<span class="number">.0001</span>_initial... OK</span><br><span class="line">  Applying admin<span class="number">.0001</span>_initial... OK</span><br><span class="line">  Applying admin<span class="number">.0002</span>_logentry_remove_auto_add... OK</span><br><span class="line">  Applying contenttypes<span class="number">.0002</span>_remove_content_type_name... OK</span><br><span class="line">  Applying auth<span class="number">.0002</span>_alter_permission_name_max_length... OK</span><br><span class="line">  Applying auth<span class="number">.0003</span>_alter_user_email_max_length... OK</span><br><span class="line">  Applying auth<span class="number">.0004</span>_alter_user_username_opts... OK</span><br><span class="line">  Applying auth<span class="number">.0005</span>_alter_user_last_login_null... OK</span><br><span class="line">  Applying auth<span class="number">.0006</span>_require_contenttypes_0002... OK</span><br><span class="line">  Applying auth<span class="number">.0007</span>_alter_validators_add_error_messages... OK</span><br><span class="line">  Applying auth<span class="number">.0008</span>_alter_user_username_max_length... OK</span><br><span class="line">  Applying auth<span class="number">.0009</span>_alter_user_last_name_max_length... OK</span><br><span class="line">  Applying booktest<span class="number">.0001</span>_initial... OK</span><br><span class="line">  Applying sessions<span class="number">.0001</span>_initial... OK       //这是对他来执行的迁移文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>Django 默认使用的数据库是 sqlite3 的数据库</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- sqlite3 是一个关系型数据库</span><br><span class="line">- 也是一个小型数据库经常用在移动端，手机端</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="3-通过模型类操作数据表"><a href="#3-通过模型类操作数据表" class="headerlink" title="3.通过模型类操作数据表"></a>3.通过模型类操作数据表</h3><p>实例实行和例属性不是一种</p>
<p>通过shell操作数据表：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">python manage.py shell               <span class="comment">//进入shell命令</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">增加：</span><br><span class="line">from booktest.models import BookInfo        <span class="comment">//引入数据库</span></span><br><span class="line">b = BookInfo()                <span class="comment">//实例化一个数据库</span></span><br><span class="line">b.btitle = <span class="string">'天龙八部'</span>           <span class="comment">//添加名称</span></span><br><span class="line">from datetime import date        <span class="comment">//导入日期模块</span></span><br><span class="line">b.bpub_date = date(<span class="number">1990.1</span><span class="number">.1</span>)           <span class="comment">//添加日期</span></span><br><span class="line">b.save()                       <span class="comment">//保存数据</span></span><br><span class="line"></span><br><span class="line">查找：</span><br><span class="line">b2 = BookInfo.objects.get(id=<span class="number">1</span>)       <span class="comment">//通过ID查找</span></span><br><span class="line">type(b2)        <span class="comment">//返回Booktest.models.BookInfo 类型</span></span><br><span class="line">b2.btitle           <span class="comment">//返回数据</span></span><br><span class="line">b2.id                <span class="comment">//返回数据</span></span><br><span class="line">  </span><br><span class="line">修改：       <span class="comment">//修改是建立在查找的基础伤</span></span><br><span class="line">b2.bpub_date = date(<span class="number">1990.10</span><span class="number">.10</span>)       <span class="comment">//直接修改玩是不会改变</span></span><br><span class="line">b2.save()                <span class="comment">//需要save保存</span></span><br><span class="line">    </span><br><span class="line">删除：</span><br><span class="line">b2.delete()                 <span class="comment">//指定删除</span></span><br></pre></td></tr></table></figure>

<h2 id="八-后台管理"><a href="#八-后台管理" class="headerlink" title="八.后台管理"></a>八.后台管理</h2><ul>
<li><p>本地化</p>
<ul>
<li><p>语言和时区的本地化</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LANGUAGE_CODE=&apos;zh-hans&apos;</span><br><span class="line">TIME_ZONE=&apos;Asia/Shanghai&apos;        //这里面没有背景时间，只有亚洲上海的时间</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改setting.py文件</p>
</li>
</ul>
</li>
<li><p>创建管理员</p>
<p>命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure>
</li>
<li><p>注册模型类</p>
<ul>
<li>在应用下的admin.py 中注册模型类</li>
<li>告诉Django框架根据注册的模型类来生成对表管理页面</li>
<li>进入admin后如果想直接显示name可以：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def __str__(self):</span><br><span class="line">	return self.name              //返回表的name字段</span><br></pre></td></tr></table></figure>


</li>
</ul>
<ul>
<li><p>自定义管理页面</p>
<ul>
<li><p>自定义模型管理类。模型管理类就是告诉Django再生产管理页面上显示那些内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> .<span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment">#自定义模型管理类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BookInfoAdmin</span><span class="params">(admin.ModelAdmin)</span>:</span></span><br><span class="line">    <span class="string">'''图书模型管理类'''</span></span><br><span class="line">    list_display = [<span class="string">'id'</span>,<span class="string">'btitle'</span>,<span class="string">'bpub_date'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#第二个参数放模型管理类的类名 </span></span><br><span class="line">admin.site.register(models.BookInfo,BookInfoAdmin)  </span><br><span class="line">admin.site.register(models.Studeng)</span><br><span class="line">admin.site.register(models.HeroInfo)</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="九-视图"><a href="#九-视图" class="headerlink" title="九.视图"></a>九.视图</h2><p>在Django中，通过浏览器去请求一个页面时，使用视图函数来处理这个请求的视图函数处理之后，要给浏览器返回页面内容。</p>
<h3 id="1-视图函数的使用-仅供参考"><a href="#1-视图函数的使用-仅供参考" class="headerlink" title="1.视图函数的使用(仅供参考)"></a>1.视图函数的使用(仅供参考)</h3><h4 id="定义视图函数"><a href="#定义视图函数" class="headerlink" title="- 定义视图函数"></a>- 定义视图函数</h4><ul>
<li><p>视图函数定义在views.py中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"><span class="comment">#Create your views here.</span></span><br><span class="line"><span class="comment">#1.定义视图函数，HttpResponse</span></span><br><span class="line"><span class="comment">#2.进行url配置，建立url地址和视图的对应关系</span></span><br><span class="line"><span class="comment">#http://127.0.0.1:8000/index</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(request)</span>:</span></span><br><span class="line"><span class="comment">#进行处理 ,和M和T进行交互</span></span><br><span class="line">	<span class="keyword">return</span> HttpResponse(<span class="string">'hello python'</span>)</span><br></pre></td></tr></table></figure>

<p>视图函数必须有一个 request ，进行处理之后，需要返回一个HttpResponse的类对象，Hello python 就是返回给浏览器的内容</p>
<p>####- 进行url配置</p>
<ol>
<li>所有的url配置都定义一个叫做urlpattems的列表中</li>
<li>每一个配置都会调用url函数第一个参数是正则表达式，第二个参数是对应的处理动作，可以写一个视图函数的名字。</li>
<li>和url 字符串进行正则匹配，匹配成功则执行后面响应的动作。</li>
<li><strong>对应的动作可以是一个视图函数的名字，也可以是包含一个应用的urls.py文件</strong></li>
</ol>
<p>url 配置的目的是让建立url和视图函数的对应关系，url配置定义在urlpatterns的列表中，每一个配置项都调用url函数。</p>
<h5 id="主路由"><a href="#主路由" class="headerlink" title="主路由"></a>主路由</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin             //主路由文件的admin管理员</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,re_path,include     //include 是命名子路由用的</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">'admin/'</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">''</span>,include(<span class="string">'booktest.urls'</span>))            //定义子路由 （应用名字+子路由文件）</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h5 id="子路由"><a href="#子路由" class="headerlink" title="子路由"></a>子路由</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from django.conf.urls import url</span><br><span class="line">  from django.urls import path,re_path</span><br><span class="line">  from .import views</span><br><span class="line"></span><br><span class="line">  urlpatterns = [</span><br><span class="line">      path(&apos;index/&apos;, views.index),</span><br><span class="line">      path(&apos;&apos;,views.index),</span><br><span class="line">      url(r&apos;^index/$&apos;,views.index),</span><br><span class="line">      re_path(r&apos;index&apos;,views.index),</span><br><span class="line">  ]</span><br></pre></td></tr></table></figure>


</li>
</ul>
<p>  url函数有两个参数，第一个是一个正则表达式，第二个是对应的处理动作。</p>
<p>  配置url时候有两种语法格式：</p>
<ol>
<li><p>url(正则表达式，视图函数名)</p>
</li>
<li><p>url(正则表达式，include(应用中的urls文件))</p>
<p>工作中配置url时，首先在项目的ulrs.py 文件中添加配置项是，并不写具体的url和视图函数之间的对应关系，而是包含具体应用的urls.py 文件，在应用的urls.py文件中写 url 和视图函数的对应关系。</p>
</li>
</ol>
<h3 id="2-url匹配过程-（正则）"><a href="#2-url匹配过程-（正则）" class="headerlink" title="2.url匹配过程 （正则）"></a>2.url匹配过程 （正则）</h3><p>  在项目的urls.py 文件中包含具体应用的urls.py文件，应用的urls.py文件中写url和视图函数的对应关系。</p>
<h2 id="十-模板"><a href="#十-模板" class="headerlink" title="十.模板"></a>十.模板</h2><p>模板不仅仅是一个HTML文件，</p>
<ul>
<li>可以在里面定义变量。</li>
<li>还可以写类似于编程语言的语句。</li>
</ul>
<h3 id="1-模板的使用"><a href="#1-模板的使用" class="headerlink" title="1.模板的使用"></a>1.模板的使用</h3><ol>
<li><p>创建模板文件夹   template</p>
</li>
<li><p>配置模板目录</p>
<p>项目的setting.py里面有一个TEMPLATES配置项</p>
<p>配置文件里面有一个常量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#项目目录的绝对路径，项目不论放到哪个目录下面都能通过BASE_DIR把它的绝对路径拿到</span><br><span class="line">BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))</span><br></pre></td></tr></table></figure>

<p>设置的时候我们就可以把我们的 BASE_DIR和tmplate拼接一下就可以了</p>
<p>拼接的时候要使用os.path.json(BASE_DIR,’template’)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">TEMPLATES = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="string">'BACKEND'</span>: <span class="string">'django.template.backends.django.DjangoTemplates'</span>,</span><br><span class="line">        <span class="string">'DIRS'</span>: [os.path.join(BASE_DIR, <span class="string">'templates'</span>)],   //设置模板文件目录</span><br><span class="line">        <span class="string">'APP_DIRS'</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">'OPTIONS'</span>: &#123;</span><br><span class="line">            <span class="string">'context_processors'</span>: [</span><br><span class="line">                <span class="string">'django.template.context_processors.debug'</span>,</span><br><span class="line">                <span class="string">'django.template.context_processors.request'</span>,</span><br><span class="line">                <span class="string">'django.contrib.auth.context_processors.auth'</span>,</span><br><span class="line">                <span class="string">'django.contrib.messages.context_processors.messages'</span>,</span><br><span class="line">            ],</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用模板文件      ps:老款的</p>
<ul>
<li><p>加载模板文件</p>
<p>去模板目录下面获取html的内容，得到一个模板对象</p>
</li>
<li><p>定义模板上下文</p>
<p>向模板文件传递数据</p>
</li>
<li><p>模板渲染</p>
<p>得到一个标准的html内容</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.template <span class="keyword">import</span> loader,RequestContext</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index2</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''使用模板'''</span></span><br><span class="line">    <span class="comment"># 1.加载模板文件，模板对象</span></span><br><span class="line">    temp = loader.get_template(<span class="string">'booktest/index2.html'</span>)</span><br><span class="line">    <span class="comment"># 2.定义模板上下文：给模板传递数据</span></span><br><span class="line">    context = RequestContext(request,&#123;&#125;)</span><br><span class="line">    <span class="comment"># 3.模板渲染：产生标准的HTML内容</span></span><br><span class="line">    res_html = temp.render(context)</span><br><span class="line">    <span class="comment"># 4.返回给浏览器</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(res_html)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>定义一个方法提供模板复用           //其实这个函数封装是多余的 ,Django给我们封装了render直接使用就行了</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.template <span class="keyword">import</span> loader,RequestContext</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_render</span><span class="params">(request,template_path,context_dict)</span>:</span></span><br><span class="line">    <span class="string">'''使用模板文件'''</span></span><br><span class="line">    <span class="comment"># 1.加载模板文件，模板对象</span></span><br><span class="line">    temp = loader.get_template(template_path)</span><br><span class="line">    <span class="comment"># 2.定义模板上下文：给模板传递数据</span></span><br><span class="line">    context = RequestContext(request,context_dict)</span><br><span class="line">    <span class="comment"># 3.模板渲染：产生标准的HTML内容</span></span><br><span class="line">    res_html = temp.render(context)</span><br><span class="line">    <span class="comment"># 4.返回给浏览器</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(res_html)</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="2-给模板文件传递数据"><a href="#2-给模板文件传递数据" class="headerlink" title="2.给模板文件传递数据"></a>2.给模板文件传递数据</h3><ul>
<li><p>模板变量使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;  模板变量名 &#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>for循环</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for i in list %&#125;</span><br><span class="line">    &#123;&#123; i &#125;&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>





































</li>
</ul>
  </article>
  <aside class="table-content" id="site-toc">
  <div class="table-content-title">
    <i class="fa fa-arrow-right fa-lg" id="site-toc-hide-btn"></i>
    <span>目录</span>
  </div>
  <div class="table-content-main">
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#一-软件框架-1"><span class="toc-text">一.软件框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二-MVC框架"><span class="toc-text">二.MVC框架</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三-MVT"><span class="toc-text">三.MVT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#四：虚拟环境"><span class="toc-text">四：虚拟环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#五-项目创建"><span class="toc-text">五:项目创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-目录结构"><span class="toc-text">1.目录结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-创建应用"><span class="toc-text">2.创建应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#六-ORM"><span class="toc-text">六.ORM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#七-模型类"><span class="toc-text">七.模型类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-模型类设计"><span class="toc-text">1.模型类设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-模型类生成表"><span class="toc-text">2.模型类生成表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-通过模型类操作数据表"><span class="toc-text">3.通过模型类操作数据表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#八-后台管理"><span class="toc-text">八.后台管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#九-视图"><span class="toc-text">九.视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-视图函数的使用-仅供参考"><span class="toc-text">1.视图函数的使用(仅供参考)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#定义视图函数"><span class="toc-text">- 定义视图函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#主路由"><span class="toc-text">主路由</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#子路由"><span class="toc-text">子路由</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-url匹配过程-（正则）"><span class="toc-text">2.url匹配过程 （正则）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#十-模板"><span class="toc-text">十.模板</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-模板的使用"><span class="toc-text">1.模板的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-给模板文件传递数据"><span class="toc-text">2.给模板文件传递数据</span></a></li></ol></li></ol>
  </div>
</aside>
  
    <aside class="passage-copyright">
      <div>本文作者: 王嘉璐</div>
      
        <div>
          原文链接: 
          <a href="" target="_blank">http://yoursite.com/passages/1.Django基础/</a>
        </div>
      
      <div>
        版权声明: 本博客所有文章除特别声明外, 均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议. 转载请注明出处!
      </div>
    </aside>
  
  
    <div class="passage-tags">
     
      <a href="/tags/Django/"><i class="fa fa-tags"></i>Django</a>
    
    </div>
  
</div>

    </main>
    
    <div class="site-footer-wrapper">
  <footer class="site-footer">
    
    <div class="site-footer-info">
      <i class="fa fa-clock-o"></i> 本站已稳定运行<span id="site-time"></span>
    </div>
    
    
    <div class="site-footer-info">
      <i class="fa fa-copyright"></i> 
      2019 <a href="https://github.com/dongyuanxin/theme-ad/" target="_blank">Theme-AD</a>.
      Created by <a href="https://godbmw.com/" target="_blank">GodBMW</a>.
      All rights reserved.
    </div>
  </footer>
</div>
    <div id="site-layer" style="display:none;">
  <div class="site-layer-content">
    <div class="site-layer-header">
      <span class="site-layer-header-title" id="site-layer-title"></span>
      <i class="fa fa-close" id="site-layer-close"></i>
    </div>
    <div class="site-layer-body" id="site-layer-container">
      <div class="site-layer-input" id="site-layer-search" style="display: none;">
        <div class="site-layer-input-choose">
          <a href="javascript:void(0);" title="Change Search Engine">Google</a>
        </div>
        <input type="text">
        <i class="fa fa-search"></i>
      </div>
      
        <div class="site-layer-reward" id="site-layer-reward" style="display: none;">
          
            <div>
              <img src="/images/wechat.png" alt="WeChat">
              
                <p>WeChat</p>
              
            </div>
          
            <div>
              <img src="/images/alipay.png" alt="WeChatID">
              
                <p>WeChatID</p>
              
            </div>
          
        </div>
      
      <div id="site-layer-welcome" style="display:none;"></div>
    </div>
  </div>
</div>
    

<div class="bottom-bar">
  <div class="bottom-bar-left">
    <a href="/passages/Nginx+uwsgi安装配置/" data-enable="true">
      <i class="fa fa-arrow-left"></i>
    </a>
    <a href="/passages/2.Django-Hello1/" data-enable="true">
      <i class="fa fa-arrow-right"></i>
    </a>
  </div>
  <div class="bottom-bar-right">
    <a href="javascript:void(0);" data-enable="true" id="site-toc-show-btn">
      <i class="fa fa-bars"></i>
    </a>
    
    <a href="javascript:void(0);" id="site-toggle-share-btn">
      <i class="fa fa-share-alt"></i>
    </a>
    
      <a href="javascript:void(0);" id="site-reward">
        <i class="fa fa-thumbs-up"></i>
      </a>
    
    <a href="javascript:void(0);" id="back-top-btn">
      <i class="fa fa-chevron-up"></i>
    </a>
  </div>
</div>
    <div id="share-btn">
  
  
  
  
  
</div>
    





    
  </body>
</html>